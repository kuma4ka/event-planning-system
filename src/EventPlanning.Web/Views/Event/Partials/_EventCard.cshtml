@using EventPlanning.Application.DTOs.Event
@using EventPlanning.Domain.Enums
@model EventDto

@{
    var isPast = Model.Date < DateTime.Now;
}

<div class="col-md-6 col-lg-4 d-flex">
    <div class="card h-100 w-100 shadow-sm border-0 hover-effect overflow-hidden">

        <div class="position-relative">
            @if (!string.IsNullOrEmpty(Model.VenueImageUrl))
            {
                <img src="@Model.VenueImageUrl" class="card-img-top" style="height: 200px; object-fit: cover;"
                    alt="@Model.Name">
            }
            else
            {
                <div class="card-img-top w-100 d-flex align-items-center justify-content-center text-white"
                    style="height: 200px; background: linear-gradient(135deg, var(--color-dark-teal), var(--color-air-force-blue));">
                    <i class="bi bi-calendar-event fs-1 opacity-50"></i>
                </div>
            }

            <div class="position-absolute top-0 end-0 m-3">
                @if (isPast)
                {
                    <span class="badge bg-secondary shadow-sm">Completed</span>
                }
                else
                {
                    <span class="badge bg-success shadow-sm">Upcoming</span>
                }
            </div>
        </div>

        <div class="card-body d-flex flex-column p-4">
            <div class="d-flex justify-content-between align-items-start mb-2">
                <span class="badge border fw-normal" style="background-color: var(--bg-body); color: var(--text-main);">
                    @Model.Type.GetDisplayName()
                </span>
                <small class="fw-bold" style="color: var(--text-muted);">
                    <i class="bi bi-calendar3 me-1"></i> @Model.Date.ToString("MMM dd")
                </small>
            </div>

            <h5 class="card-title fw-bold mb-1 fs-5">
                <a asp-controller="Event" asp-action="Details" asp-route-id="@Model.Id"
                    class="text-decoration-none stretched-link" style="color: var(--text-main);">
                    @Model.Name
                </a>
            </h5>

            <div class="small mb-3" style="color: var(--text-muted);">
                <i class="bi bi-clock me-1"></i> @Model.Date.ToString("HH:mm")
            </div>

            <div class="d-flex align-items-center small mb-3" style="color: var(--text-muted);">
                <i class="bi bi-geo-alt-fill me-2 text-danger opacity-75"></i>
                <span class="text-truncate">@Model.VenueName</span>
            </div>

            <div class="mt-auto pt-3 border-top d-flex justify-content-end gap-2"
                style="position: relative; z-index: 2; border-color: var(--border-light) !important;">

                <button type="button" class="btn-action text-primary" data-bs-toggle="modal"
                    data-bs-target="#shareModal"
                    data-event-url="@Url.Action("Details", "Event", new { id = Model.Id }, Context.Request.Scheme)"
                    title="Share Event">
                    <i class="bi bi-share-fill"></i> Share
                </button>

                @if (!isPast)
                {
                    <a asp-controller="Event" asp-action="Edit" asp-route-id="@Model.Id" class="btn-action text-warning"
                        title="Edit Event">
                        <i class="bi bi-pencil-fill"></i> Edit
                    </a>
                }

                <button type="button" class="btn-action text-danger" data-bs-toggle="modal"
                    data-bs-target="#deleteModal" data-event-id="@Model.Id" data-event-name="@Model.Name"
                    title="Delete Event">
                    <i class="bi bi-trash-fill"></i> Remove
                </button>
            </div>
        </div>
    </div>
</div>
