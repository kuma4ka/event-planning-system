@model EventPlanning.Application.DTOs.Guest.GuestDto

@{
    var isOrganizer = ViewData["IsOrganizer"] as bool? ?? false;
    var isPast = ViewData["IsPast"] as bool? ?? false;

    var fullName = $"{Model.FirstName} {Model.LastName}";
    var initials = !string.IsNullOrEmpty(Model.FirstName) ? Model.FirstName.Substring(0, 1).ToUpper() : "G";
}

<div class="guest-list-item justify-content-between">
    <div class="d-flex align-items-center overflow-hidden">
        
        <div class="guest-avatar flex-shrink-0">
            @initials
        </div>

        <div class="overflow-hidden ms-3">
            <span class="d-block text-truncate fw-bold" 
                  style="color: var(--text-main); max-width: 180px;" 
                  title="@fullName">
                @fullName
            </span>
            @if (isOrganizer)
            {
                <small class="d-block text-truncate" 
                       style="color: var(--text-muted); font-size: 0.75rem; max-width: 180px;"
                       title="@Model.Email">
                    @Model.Email
                </small>
            }
        </div>
    </div>

    @if (isOrganizer && !isPast)
    {
        <div class="dropdown ms-2">
            <button class="btn btn-sm btn-link p-0 px-2" 
                    type="button" 
                    data-bs-toggle="dropdown"
                    aria-expanded="false"
                    style="color: var(--text-muted);">
                <i class="bi bi-three-dots-vertical"></i>
            </button>
            
            <ul class="dropdown-menu dropdown-menu-end shadow-sm border-0 animate-fade-in" 
                style="background-color: var(--bg-surface);">
                <li>
                    <button class="dropdown-item small" 
                            style="color: var(--text-main);"
                            onclick="window.openEditGuestModal('@Model.Id', '@Model.FirstName', '@Model.LastName', '@Model.Email', '@Model.CountryCode', '@Model.PhoneNumber')">
                        <i class="bi bi-pencil me-2 text-warning"></i> Edit
                    </button>
                </li>
                <li>
                    <hr class="dropdown-divider my-1" style="border-color: var(--border-light);">
                </li>
                <li>
                    <button class="dropdown-item small text-danger"
                            onclick="window.openDeleteGuestModal('@Model.Id')">
                        <i class="bi bi-trash me-2"></i> Remove
                    </button>
                </li>
            </ul>
        </div>
    }
</div>