@model HomeIndexViewModel

@{
    ViewData["Title"] = "Find Events";
}

<partial name="Partials/_HomeHero" />

<div class="container mb-5" id="events-grid">
    <vc:event-filter controller-name="Home" action-name="Index" search-term="@Model.SearchTerm" type="@Model.Type"
        from="@Model.From" to="@Model.To" sort-order="@ViewBag.CurrentSort" is-hero-overlay="true" show-search="false">
    </vc:event-filter>

    @if (!Model.Events.Items.Any())
    {
        <div class="text-center py-5">
            <div class="mb-3">
                <i class="bi bi-search display-1 text-muted opacity-25"></i>
            </div>
            <h3 class="text-dark">No events found</h3>
            <p class="text-muted">Try adjusting your filters or search criteria.</p>
            <a asp-action="Index" class="btn btn-outline-primary mt-2">Clear All Filters</a>
        </div>
    }
    else
    {
        <div class="d-flex justify-content-between align-items-center mb-4 mt-5">
            <div>
                <h4 class="mb-0 fw-bold display-6" style="color: var(--color-ink-black); font-size: 1.75rem;">Upcoming
                    Events</h4>
                <span class="badge bg-white text-dark border shadow-sm px-3 py-2 mt-2 d-inline-block"
                    style="border-radius: 8px !important; color: var(--color-dark-teal) !important;">
                    @Model.Events.TotalCount results
                </span>
            </div>

            <div class="d-flex ms-3">
                <button id="btnGridView" class="view-toggle-btn active" title="Grid View">
                    <i class="bi bi-grid-fill"></i>
                </button>
                <button id="btnListView" class="view-toggle-btn" title="List View">
                    <i class="bi bi-list-ul"></i>
                </button>
            </div>
        </div>

        <div id="itemsContainer" class="row g-4 mb-5">
            @foreach (var item in Model.Events.Items)
            {
                <partial name="Partials/_PublicEventCard" model="item" />
            }
        </div>

        @if (Model.Events.TotalPages > 1)
        {
            <nav aria-label="Page navigation" class="mt-5">
                <ul class="pagination justify-content-center">
                    <li class="page-item @(Model.Events.PageNumber == 1 ? "disabled" : "")">
                        <a class="page-link" asp-action="Index" asp-route-page="@(Model.Events.PageNumber - 1)"
                            asp-route-searchTerm="@Model.SearchTerm" asp-route-type="@Model.Type"
                            asp-route-sortOrder="@ViewBag.CurrentSort" asp-route-from="@Model.From?.ToString("yyyy-MM-dd")"
                            asp-route-to="@Model.To?.ToString("yyyy-MM-dd")" aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                            <span class="ms-1">Previous</span>
                        </a>
                    </li>

                    @for (var i = 1; i <= Model.Events.TotalPages; i++)
                    {
                        var pageNumber = i;
                        <li class="page-item @(pageNumber == Model.Events.PageNumber ? "active" : "")">
                            <a class="page-link" asp-action="Index" asp-route-page="@pageNumber"
                                asp-route-searchTerm="@Model.SearchTerm" asp-route-type="@Model.Type"
                                asp-route-sortOrder="@ViewBag.CurrentSort" asp-route-from="@Model.From?.ToString("yyyy-MM-dd")"
                                asp-route-to="@Model.To?.ToString("yyyy-MM-dd")">@pageNumber</a>
                        </li>
                    }

                    <li class="page-item @(Model.Events.PageNumber == Model.Events.TotalPages ? "disabled" : "")">
                        <a class="page-link" asp-action="Index" asp-route-page="@(Model.Events.PageNumber + 1)"
                            asp-route-searchTerm="@Model.SearchTerm" asp-route-type="@Model.Type"
                            asp-route-sortOrder="@ViewBag.CurrentSort" asp-route-from="@Model.From?.ToString("yyyy-MM-dd")"
                            asp-route-to="@Model.To?.ToString("yyyy-MM-dd")" aria-label="Next">
                            <span class="me-1">Next</span>
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                </ul>
            </nav>
        }
    }
</div>